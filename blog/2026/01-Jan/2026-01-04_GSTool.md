---
id: 61
date: 2025-01-04
title: Developing a Graphical Standings Tool
category: fun
subtitle: "Part 15: Plotting PWHL data (2)"
post-series: gstool
published: true
---
First things first, I want to reduce redundancy. I've written a new function, `get_regular_values()`, to obtain regular values on the axes. Hence, the `add_regular_[breaks/ticks/tick_labels]()` functions get much simpler.
### Plotting the results of a season
A common object we'll be working with is a pair of values `(game, points)`, which I've made a `NamedTuple` called `SeasonCoordinate`.

Here's the steps to the process I've created, in order to plot the results of a season:
1. From the `DataFrame` containing the season schedule, create dictionaries:
	- `dots_dict` relating `SeasonCoordinate` values to a set of teams (which will have been at this coordinate at some point during the season)
	- `segments_dict` relating pairs `(SeasonCoordinate, SeasonCoordinate)` to a set of teams (which will have gotten this specific result at this specific game)
	- `curr_coords_dict` relating teams to `SeasonCoordinate` values (indicating the current coordinate of each team)
2. From these dictionaries, with the help of a translation function from `SeasonCoordinate` to the plot coordinates, plot the dots, segments, and labels.
	- The dots to plot are simply the keys of the dictionary `dots_dict`.
	- The segments to plot can be found from the dictionary `segments_dict`, but an extra bit of translation work will be necessary here, in order to separate overlapping segments. It will also be wise to group the segments by team, before they are plotted together.
	- The labels to plot are obvious: Just one for each team. However, in order to avoid overlaps, some more translation work will be needed to separate the labels.
### Plotting segments
The was I made the dictionary `segments_dict` really facilitates the process of separating multiple overlapping segments. Indeed, to find out how many segments are overlapping, all we have to do is find the length of the list of teams which inhabit the segment.

Then, we can iterate through this list of teams, creating its polygon `Element` object based on this information. There are a few considerations here, such as: How thick should the group of segments be?, and: How large should the space between multiple teams' overlapping segments be? My aesthetic preferences lead me to the correct answer to the second question being 4, while the first question should depend on the density of values. Such properties should be editable, though, and indeed are a prime target for keyword-only parameters.

### Plotting labels
The way the `curr_coords_dict` dictionary is created doesn't lend itself to finding overlaps. It's relatively simple, though, to make a new dictionary in a similar style to that of `segments_dict`.

To plot the labels with offsets, I edited the functions to get and add an image to the plot. This is a very convenient place to put this functionality, since I'm already calculating the SVG dimensions and position of the image, so it's just a very simple calculation away.

Finally, I wrote up a quick and dirty algorithm to offset the labels as I plot them, which works well enough for the PWHL, but won't be appropriate for leagues with more teams, such as the NFL.

I'm quite happy with the result so far!

![PWHL Graphical Standings 2026-01-04](/blog/attachments/2026/01-Jan/2026-01-04_GSTool.png)